descriptor_id: COPYPASTE
descriptor_type: other
descriptor_flavors:
  - all_flavors # Applicable to CI in any language project
  - ci_light
  - cupcake
lint_all_files: true
linters:
  # JSCPD
  - class: JsCpdLinter
    linter_name: jscpd
    linter_url: https://github.com/kucherenko/jscpd/tree/master/apps/jscpd
    linter_repo: https://github.com/kucherenko/jscpd
    linter_speed: 1
    linter_text: |
      JSCPD browses all files of your repository to detect excessive copy-pastes

      If you need to ignore folders, files or file extensions, use glob expressions `ignore` property of local `.jscpd.json` file

      Example:

      ```json
      {
        "threshold": 0,
        "reporters": ["html", "markdown"],
        "ignore": [
          "**/node_modules/**",
          "**/.git/**",
          "**/*.md",
          "**/myFolderToSkip/**"
        ]
      }
      ```
    linter_banner_image_url: https://raw.githubusercontent.com/kucherenko/jscpd/master/assets/logo.svg?sanitize=true
    linter_rules_configuration_url: https://github.com/kucherenko/jscpd/tree/master/apps/jscpd#config-file
    linter_rules_inline_disable_url: https://github.com/kucherenko/jscpd/tree/master/apps/jscpd#ignored-blocks
    linter_megalinter_ref_url: https://github.com/kucherenko/jscpd#who-uses-jscpd
    config_file_name: .jscpd.json
    cli_lint_mode: project
    cli_lint_extra_args:
      - --gitignore
      - "--reporters"
      - "console,html"
      - "--exitCode"
      - "1"
    cli_lint_extra_args_after:
      - "."
    cli_lint_errors_count: regex_number
    cli_lint_errors_regex: "Found ([0-9]+) clones"
    examples:
      - "jscpd --output ./report/copy-paste/ ."
      - "jscpd --output ./report/copy-paste/ -c .jscpd.json ."
    install:
      apk:
        - nodejs=${APK_NODEJS_VERSION}
        - npm=${APK_NPM_VERSION}
        - yarn=${APK_YARN_VERSION}
      dockerfile:
        - |-
          # renovate: datasource=repology depName=alpine_3_21/nodejs
          ARG APK_NODEJS_VERSION=22.11.0-r1
        - |-
          # renovate: datasource=repology depName=alpine_3_21/npm
          ARG APK_NPM_VERSION=10.9.1-r0
        - |-
          # renovate: datasource=repology depName=alpine_3_21/yarn
          ARG APK_YARN_VERSION=1.22.22-r1
        - |-
          # renovate: datasource=npm depName=jscpd
          ARG NPM_JSCPD_VERSION=4.0.5
      npm:
        - jscpd@${NPM_JSCPD_VERSION}
